DBMS:
sqlite

Error:
near "from": syntax error

SQL:
CREATE TEMP TABLE strata as
    select cohort_definition_id,
           row_number () over (
            partition by cohort_definition_id
                order by cohort_start_date,
                         age_group,
                         gender_concept_id,
                         race_concept_id,
                         ethnicity_concept_id
           ) as strata_id,
                cohort_start_date,
                age_group,
                gender_concept_id,
                race_concept_id,
                ethnicity_concept_id
    from (
        select distinct t0.cohort_definition_id,
                        t0.cohort_start_date,
                        floor((extract(year from t0.cohort_start_date) - p1.year_of_birth) / 5) as age_group,
                        p1.gender_concept_id,
                        p1.race_concept_id,
                        p1.ethnicity_concept_id
        from temp.target t0
        inner join main.person p1
            on t0.subject_id = p1.person_id
    ) strata


R version:
R version 4.3.2 (2023-10-31)

Platform:
aarch64-apple-darwin20

Attached base packages:
- stats
- graphics
- grDevices
- utils
- datasets
- methods
- base

Other attached packages:
- RSQLite (2.3.5)
- testthat (3.2.1)
- ConcurrentComparator (0.1.0)
- survival (3.5-7)
- Cyclops (3.4.0)
- Andromeda (0.6.5)
- dplyr (1.1.4)
- DatabaseConnector (6.3.2)